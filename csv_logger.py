import csv

#-------------------------------------------------------------------------------------------------------------------------------------------------------------
# Class to manage CSV file operations for logging ping statistics.
#-------------------------------------------------------------------------------------------------------------------------------------------------------------

class CSVLogger:

    #---------------------------------------------------------------------------------------------------------------------------------------------------------
    # Constructor
    #
    # Initialize the CSVLogger class with the file name and header.
    #
    # Args:
    #   file_name (str): The name of the CSV file.
    #   header (list): The header row for the CSV file.
    #
    #---------------------------------------------------------------------------------------------------------------------------------------------------------    
    
    def __init__ ( self, file_name, header ):
        
        self.file_name = file_name
        self.file      = open ( self.file_name, mode='w', newline='' )
        self.writer    = csv.writer ( self.file )

        self.writer.writerow ( header )

    #---------------------------------------------------------------------------------------------------------------------------------------------------------
    # Destructor
    # 
    # Ensure the file is closed when the CSVLogger object is destroyed.
    #---------------------------------------------------------------------------------------------------------------------------------------------------------

    def __del__ ( self ):
        
        self.close ()

    #---------------------------------------------------------------------------------------------------------------------------------------------------------
    # Write a row of data to the CSV file.
    #
     

    # Args:
    #    row (list): The row of data to write to the CSV file.
    #
    #---------------------------------------------------------------------------------------------------------------------------------------------------------
    
    def write_row ( self, row ):
        
        self.writer.writerow ( row )

    #---------------------------------------------------------------------------------------------------------------------------------------------------------
    # Close the CSV file.
    #---------------------------------------------------------------------------------------------------------------------------------------------------------
    
    def close ( self ):
        
        self.file.close ()

    #---------------------------------------------------------------------------------------------------------------------------------------------------------
    # Get the current statistics as a CSV row.
    #    
    # Args:
    #   arg_1 (type): Description of arg_1.
    #   arg_2 (type): Description of arg_2.
    #    
    # Returns:
    #   return_value: Description of return_value.
    #---------------------------------------------------------------------------------------------------------------------------------------------------------

    
